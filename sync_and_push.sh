#!/bin/bash

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /tmp/HA_addons || { echo "‚ùó –û—à–∏–±–∫–∞: –ø–∞–ø–∫–∞ /tmp/HA_addons –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"; exit 1; }

echo "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —É–¥–∞–ª—ë–Ω–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º..."
git pull --rebase || { echo "‚ùó –û—à–∏–±–∫–∞ git pull. –ü–æ–ø—Ä–æ–±—É–π git pull --allow-unrelated-histories –≤—Ä—É—á–Ω—É—é."; exit 1; }

echo "‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

echo "üìÇ –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω–¥–µ–∫—Å..."
git add .

echo "üìù –í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∫–æ–º–º–∏—Ç—É (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ):"
read -r COMMIT_MSG

# –ï—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—É—Å—Ç–æ–π ‚Äî –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π
if [ -z "$COMMIT_MSG" ]; then
    COMMIT_MSG="Update Home Assistant Add-ons"
fi

echo "üì¶ –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–º–∏—Ç..."
git commit -m "$COMMIT_MSG"

echo "üöÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub..."
git push

echo "‚úÖ –í—Å—ë –≥–æ—Ç–æ–≤–æ!"
